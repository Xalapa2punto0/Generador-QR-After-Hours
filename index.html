<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>QR en alta resolución con logo centrado y borde blanco</title>
<style>
  body{
    font-family:sans-serif;
    background:#f5f5f5;
    padding:20px;
  }
  .card{
    background:#fff;
    padding:20px;
    max-width:500px;
    margin:auto;
    border-radius:12px;
    box-shadow:0 4px 12px rgba(0,0,0,.1);
  }
  #qr{
    display:flex;
    justify-content:center;
    margin:20px 0;
    background:#fff;        /* marco/borde blanco */
    padding:20px;           /* grosor del marco */
    border-radius:12px;     /* esquinas redondeadas del marco */
    box-sizing:border-box;
  }
  /* Reducción visual del canvas a 300px manteniendo resolución interna 600px */
  #qr canvas {
    width: 300px !important;
    height: 300px !important;
  }
  input,button{
    padding:10px;
    font-size:16px;
    margin:6px 0;
    width:100%;
  }
  button{
    background:#0b69ff;
    color:#fff;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:600;
  }
</style>
</head>
<body>
<div class="card">
  <h1>Generador de QR en alta resolución</h1>
  <input id="text" type="text" placeholder="Texto o URL">
  <button id="gen">Generar QR</button>
  <div id="qr"></div>
  <button id="shareBtn" style="display:none;">Compartir QR</button>
</div>

<!-- Librería QRCodeStyling -->
<script src="https://unpkg.com/qr-code-styling@1.6.0/lib/qr-code-styling.js"></script>
<script>
const genBtn = document.getElementById('gen');
const qrContainer = document.getElementById('qr');
const shareBtn = document.getElementById('shareBtn');
let qrCode;

genBtn.addEventListener('click', () => {
  const text = document.getElementById('text').value.trim();
  if(!text){ alert('Escribe un texto'); return; }

  qrContainer.innerHTML = '';

  qrCode = new QRCodeStyling({
    width: 600,              // ← alta resolución
    height: 600,             // ← alta resolución
    type: 'canvas',
    data: text,
    image: 'logo.png',
    imageOptions: {
      crossOrigin: 'anonymous',
      margin: 0
    },
    dotsOptions: {
      color: '#000',
      type: 'square'
    },
    cornersSquareOptions: {
      type: 'square',
      color: '#000'
    },
    cornersDotOptions: {
      type: 'square',
      color: '#000'
    },
    backgroundOptions: {
      color: '#ffffff'
    }
  });

  qrCode.append(qrContainer);
  shareBtn.style.display = 'block';
});

shareBtn.addEventListener('click', async ()=>{
  if (!qrCode) return;
  const blob = await qrCode.getRawData('png');
  if (navigator.share &&
      navigator.canShare?.({ files: [new File([blob], 'qr.png', {type:'image/png'})] })) {
    const file = new File([blob], 'qr.png', { type: 'image/png' });
    navigator.share({
      files: [file],
      title: 'Código QR',
      text: 'Aquí está el código QR que generé'
    });
  } else {
    const text = 'Mira este código QR: (adjunta la imagen manualmente)';
    window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(text)}`,'_blank');
  }
});
</script>
</body>
</html>
